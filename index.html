<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–µ—Ç—Ä–æ –§–æ—Ä—É–º 2007 Pro - –° –ê–∫–∫–∞—É–Ω—Ç–∞–º–∏</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Verdana, Arial, sans-serif;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="4" height="4"><rect fill="%23c0c0c0" width="4" height="4"/><rect fill="%23999" x="0" y="0" width="2" height="2"/></svg>');
            background-color: #b0b0b0;
            color: #333;
            line-height: 1.4;
            font-size: 12px;
            padding: 10px;
        }

        .container {
            width: 100%;
            max-width: 1000px;
            margin: 0 auto;
        }

        .header {
            background: linear-gradient(to bottom, #1f5b9c, #1a4d7a);
            border: 2px solid #333;
            padding: 15px;
            margin-bottom: 10px;
            text-align: center;
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-left {
            flex: 1;
        }

        .header h1 {
            font-size: 24px;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .header p {
            font-size: 10px;
            color: #ddd;
            margin: 0;
        }

        .header-right {
            text-align: right;
            font-size: 11px;
        }

        .header-right p {
            margin: 2px 0;
            color: #ddd;
        }

        .header-right strong {
            color: #ffff00;
        }

        .nav-bar {
            background: linear-gradient(to bottom, #8b8b8b, #707070);
            border: 2px solid #333;
            padding: 8px 10px;
            margin-bottom: 10px;
            display: flex;
            gap: 10px;
            box-shadow: inset 1px 1px 0 #fff, inset -1px -1px 0 #000;
            flex-wrap: wrap;
        }

        .nav-bar a {
            color: white;
            text-decoration: none;
            font-weight: bold;
            cursor: pointer;
            padding: 4px 10px;
            background: linear-gradient(to bottom, #a0a0a0, #808080);
            border: 2px outset #dfdfdf;
            border-radius: 3px;
            font-size: 11px;
            transition: all 0.1s;
        }

        .nav-bar a:hover {
            background: linear-gradient(to bottom, #b0b0b0, #909090);
            border-style: inset;
        }

        .nav-bar a.active {
            background: linear-gradient(to bottom, #707070, #505050);
            border-style: inset;
            color: #ffff00;
        }

        .main-content {
            display: grid;
            grid-template-columns: 200px 1fr;
            gap: 10px;
        }

        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .sidebar-panel {
            background: #e8e8e8;
            border: 2px solid;
            border-color: #dfdfdf #808080 #808080 #dfdfdf;
            box-shadow: inset 1px 1px 0 #fff, inset -1px -1px 0 #000;
        }

        .panel-header {
            background: linear-gradient(to right, #000080, #1084d7);
            color: white;
            padding: 8px 10px;
            font-weight: bold;
            font-size: 11px;
        }

        .panel-body {
            padding: 10px;
            background: #f5f5f5;
            font-size: 11px;
        }

        .panel-body p {
            margin: 5px 0;
        }

        .panel-body a {
            display: block;
            color: #000080;
            text-decoration: underline;
            cursor: pointer;
            margin: 3px 0;
            padding: 2px;
        }

        .panel-body a:hover {
            background: #e0e0e0;
        }

        .forum-section {
            background: #e8e8e8;
            border: 2px solid;
            border-color: #dfdfdf #808080 #808080 #dfdfdf;
            box-shadow: inset 1px 1px 0 #fff, inset -1px -1px 0 #000;
        }

        .section-header {
            background: linear-gradient(to right, #000080, #1084d7);
            color: white;
            padding: 8px 12px;
            font-weight: bold;
            font-size: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .section-body {
            padding: 0;
        }

        .forum-item {
            display: grid;
            grid-template-columns: 50px 1fr 70px 70px;
            gap: 10px;
            padding: 10px 12px;
            border-bottom: 1px solid #dfdfdf;
            align-items: center;
            background: white;
            transition: background 0.2s;
        }

        .forum-item:hover {
            background: #f0f0f0;
        }

        .forum-item:last-child {
            border-bottom: none;
        }

        .forum-icon {
            text-align: center;
            font-size: 20px;
        }

        .forum-info h3 {
            font-size: 12px;
            margin: 0 0 2px 0;
            color: #000080;
            text-decoration: underline;
            cursor: pointer;
        }

        .forum-info h3:hover {
            color: #1084d7;
        }

        .forum-info p {
            font-size: 10px;
            margin: 0;
            color: #666;
        }

        .forum-stats {
            text-align: center;
            font-size: 10px;
        }

        .thread-item {
            display: grid;
            grid-template-columns: 30px 1fr 50px 70px;
            gap: 8px;
            padding: 8px 12px;
            border-bottom: 1px solid #dfdfdf;
            align-items: center;
            background: white;
            transition: background 0.2s;
        }

        .thread-item:hover {
            background: #f0f0f0;
        }

        .thread-item:last-child {
            border-bottom: none;
        }

        .thread-icon {
            text-align: center;
            font-size: 16px;
        }

        .thread-info h4 {
            font-size: 11px;
            margin: 0 0 2px 0;
            color: #000080;
            cursor: pointer;
        }

        .thread-info h4:hover {
            color: #1084d7;
        }

        .thread-info p {
            font-size: 9px;
            margin: 0;
            color: #666;
        }

        .lock-badge {
            background: #ffcccc;
            color: #cc0000;
            padding: 2px 4px;
            border-radius: 2px;
            font-size: 9px;
            font-weight: bold;
            display: inline-block;
        }

        .button {
            background: linear-gradient(to bottom, #c0c0c0, #a0a0a0);
            border: 2px outset #dfdfdf;
            color: #000;
            padding: 6px 12px;
            cursor: pointer;
            font-weight: bold;
            font-size: 11px;
            border-radius: 3px;
            transition: all 0.1s;
        }

        .button:hover {
            background: linear-gradient(to bottom, #d0d0d0, #b0b0b0);
        }

        .button:active {
            border-style: inset;
            background: linear-gradient(to bottom, #a0a0a0, #c0c0c0);
        }

        .button.primary {
            background: linear-gradient(to bottom, #1f5b9c, #1a4d7a);
            color: white;
            border-color: #fff;
        }

        .button.primary:hover {
            background: linear-gradient(to bottom, #2a6aad, #1f5b9c);
        }

        .button.danger {
            background: linear-gradient(to bottom, #cc0000, #990000);
            color: white;
        }

        .button.danger:hover {
            background: linear-gradient(to bottom, #dd0000, #aa0000);
        }

        .input-field {
            border: 2px inset #dfdfdf;
            padding: 4px 6px;
            font-family: Verdana, Arial, sans-serif;
            font-size: 11px;
            background: white;
            color: #000;
        }

        .textarea {
            border: 2px inset #dfdfdf;
            padding: 6px 8px;
            font-family: Verdana, Arial, sans-serif;
            font-size: 11px;
            background: white;
            color: #000;
            width: 100%;
            min-height: 100px;
            resize: vertical;
        }

        .form-group {
            margin-bottom: 10px;
        }

        .form-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 4px;
            font-size: 11px;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
        }

        .post-item {
            background: #f0f0f0;
            border: 2px solid;
            border-color: #dfdfdf #808080 #808080 #dfdfdf;
            margin-bottom: 10px;
        }

        .post-header {
            background: linear-gradient(to right, #a0a0a0, #808080);
            color: white;
            padding: 6px 10px;
            font-weight: bold;
            font-size: 11px;
            display: flex;
            justify-content: space-between;
        }

        .post-body {
            display: flex;
            gap: 10px;
            padding: 10px;
            background: white;
        }

        .post-avatar {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #1f5b9c, #1a4d7a);
            border: 1px solid #333;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 18px;
            border-radius: 3px;
            flex-shrink: 0;
        }

        .post-content {
            flex: 1;
            font-size: 11px;
            line-height: 1.5;
        }

        .post-footer {
            background: #e8e8e8;
            padding: 6px 10px;
            font-size: 9px;
            color: #666;
            border-top: 1px solid #dfdfdf;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            overflow-y: auto;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-content {
            background: #c0c0c0;
            border: 3px solid;
            border-color: #dfdfdf #808080 #808080 #dfdfdf;
            box-shadow: inset 1px 1px 0 #fff, inset -1px -1px 0 #000;
            width: 100%;
            max-width: 600px;
            max-height: 85vh;
            overflow-y: auto;
        }

        .modal-header {
            background: linear-gradient(to right, #000080, #1084d7);
            color: white;
            padding: 4px 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: bold;
            font-size: 12px;
        }

        .modal-close {
            background: linear-gradient(to bottom, #c0c0c0, #a0a0a0);
            border: 2px outset #dfdfdf;
            width: 20px;
            height: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: bold;
        }

        .modal-close:active {
            border-style: inset;
        }

        .modal-body {
            padding: 12px;
            background: #c0c0c0;
        }

        .no-data {
            padding: 20px;
            text-align: center;
            color: #666;
            background: white;
            font-size: 12px;
        }

        .message-item {
            background: white;
            border: 1px solid #dfdfdf;
            padding: 10px;
            margin-bottom: 8px;
            border-radius: 3px;
        }

        .message-item:hover {
            background: #f5f5f5;
        }

        .message-from {
            font-weight: bold;
            color: #000080;
            font-size: 11px;
            margin-bottom: 4px;
        }

        .message-text {
            font-size: 11px;
            margin-bottom: 4px;
            line-height: 1.4;
        }

        .message-time {
            font-size: 9px;
            color: #999;
        }

        .view {
            display: none;
        }

        .view.active {
            display: block;
        }

        .action-bar {
            background: linear-gradient(to bottom, #8b8b8b, #707070);
            border: 2px solid #333;
            padding: 8px 10px;
            margin-bottom: 10px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            box-shadow: inset 1px 1px 0 #fff, inset -1px -1px 0 #000;
        }

        .user-status {
            padding: 10px;
            background: #f0f0f0;
            border: 1px solid #dfdfdf;
            border-radius: 3px;
            font-size: 11px;
            margin-bottom: 10px;
        }

        .user-status strong {
            color: #000080;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }

            .sidebar {
                display: none;
            }

            .header {
                flex-direction: column;
                text-align: center;
            }

            .header-left, .header-right {
                flex: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-left">
                <h1>üñ•Ô∏è –†–µ—Ç—Ä–æ –§–æ—Ä—É–º 2007 Pro</h1>
                <p>–° —Å–∏—Å—Ç–µ–º–æ–π –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏</p>
            </div>
            <div class="header-right" id="header-status">
                <p>–í—ã –Ω–µ –≤–æ—à–ª–∏</p>
            </div>
        </div>

        <!-- Navigation -->
        <div class="nav-bar">
            <a class="nav-item active" onclick="showView('forums')">üìÇ –§–æ—Ä—É–º—ã</a>
            <a class="nav-item" onclick="showView('messages')">‚úâÔ∏è –°–æ–æ–±—â–µ–Ω–∏—è</a>
            <a class="nav-item" onclick="showView('profile')">üë§ –ü—Ä–æ—Ñ–∏–ª—å</a>
            <a class="nav-item" onclick="showLoginModal()">üîì –í—Ö–æ–¥/–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
            <a class="nav-item" onclick="logout()" id="logout-btn" style="display:none;">üö™ –í—ã—Ö–æ–¥</a>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Sidebar -->
            <div class="sidebar">
                <div class="sidebar-panel">
                    <div class="panel-header">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div>
                    <div class="panel-body">
                        <p><strong>–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</strong> <span id="total-users">0</span></p>
                        <p><strong>–û–Ω–ª–∞–π–Ω:</strong> <span id="online-users">0</span></p>
                        <p><strong>–¢–µ–º:</strong> <span id="total-threads">0</span></p>
                        <p><strong>–°–æ–æ–±—â–µ–Ω–∏–π:</strong> <span id="total-posts">0</span></p>
                    </div>
                </div>

                <div class="sidebar-panel">
                    <div class="panel-header">üë• –ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</div>
                    <div class="panel-body" id="latest-users">
                        <p style="color: #999;">–ù–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</p>
                    </div>
                </div>

                <div class="sidebar-panel">
                    <div class="panel-header">‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</div>
                    <div class="panel-body">
                        <p>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ —Ä–µ—Ç—Ä–æ-—Ñ–æ—Ä—É–º –≤ —Å—Ç–∏–ª–µ 2007 –≥–æ–¥–∞!</p>
                        <p>–ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ –æ–±—Å—É–∂–¥–∞—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–µ –≤–∞—Å —Ç–µ–º—ã, –ø–∏—Å–∞—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å –¥—Ä—É–≥–∏–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏.</p>
                    </div>
                </div>
            </div>

            <!-- Content Area -->
            <div style="display: flex; flex-direction: column; gap: 10px;">
                <!-- Forums View -->
                <div id="forums" class="view active">
                    <div class="forum-section">
                        <div class="section-header">üìã –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ñ–æ—Ä—É–º–∞</div>
                        <div class="section-body" id="forums-list">
                            <div class="forum-item">
                                <div class="forum-icon">üìÅ</div>
                                <div class="forum-info">
                                    <h3 onclick="showForum(0)">–û—Å–Ω–æ–≤–Ω–æ–µ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ</h3>
                                    <p>–¢–µ–º—ã –æ–±—â–µ–≥–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞ –∏ –Ω–æ–≤–æ—Å—Ç–∏</p>
                                </div>
                                <div class="forum-stats">
                                    <strong id="forum-0-threads">0</strong><br><small>—Ç–µ–º</small>
                                </div>
                                <div class="forum-stats">
                                    <strong id="forum-0-posts">0</strong><br><small>–ø–æ—Å—Ç–æ–≤</small>
                                </div>
                            </div>
                            <div class="forum-item">
                                <div class="forum-icon">üíª</div>
                                <div class="forum-info">
                                    <h3 onclick="showForum(1)">–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</h3>
                                    <p>–û–±—Å—É–∂–¥–µ–Ω–∏–µ –ü–ö –∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞</p>
                                </div>
                                <div class="forum-stats">
                                    <strong id="forum-1-threads">0</strong><br><small>—Ç–µ–º</small>
                                </div>
                                <div class="forum-stats">
                                    <strong id="forum-1-posts">0</strong><br><small>–ø–æ—Å—Ç–æ–≤</small>
                                </div>
                            </div>
                            <div class="forum-item">
                                <div class="forum-icon">üéÆ</div>
                                <div class="forum-info">
                                    <h3 onclick="showForum(2)">–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è</h3>
                                    <p>–ò–≥—Ä—ã, –∫–∏–Ω–æ –∏ —Ö–æ–±–±–∏</p>
                                </div>
                                <div class="forum-stats">
                                    <strong id="forum-2-threads">0</strong><br><small>—Ç–µ–º</small>
                                </div>
                                <div class="forum-stats">
                                    <strong id="forum-2-posts">0</strong><br><small>–ø–æ—Å—Ç–æ–≤</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Forum Threads View -->
                <div id="forum-view" class="view" style="display:none;">
                    <div class="action-bar">
                        <button class="button" onclick="backToForums()">‚Üê –ù–∞–∑–∞–¥</button>
                        <button class="button primary" onclick="openNewThreadModal()" id="create-thread-btn">üìù –ù–æ–≤–∞—è —Ç–µ–º–∞</button>
                    </div>
                    <div class="forum-section">
                        <div class="section-header" id="forum-title">–¢–µ–º—ã —Ñ–æ—Ä—É–º–∞</div>
                        <div class="section-body" id="threads-list"></div>
                    </div>
                </div>

                <!-- Thread View -->
                <div id="thread-view" class="view" style="display:none;">
                    <div class="action-bar">
                        <button class="button" onclick="backToForum()">‚Üê –ö —Ñ–æ—Ä—É–º—É</button>
                    </div>
                    <div class="forum-section">
                        <div class="section-header" id="thread-title">–¢–µ–º–∞</div>
                        <div class="section-body" id="posts-list"></div>
                    </div>
                    <div class="action-bar">
                        <button class="button primary" onclick="openReplyModal()" id="reply-btn">üìù –û—Ç–≤–µ—Ç–∏—Ç—å</button>
                    </div>
                </div>

                <!-- Messages View -->
                <div id="messages" class="view" style="display:none;">
                    <div class="user-status" id="message-status"></div>
                    <div class="action-bar">
                        <button class="button primary" onclick="openSendMessageModal()">‚úâÔ∏è –ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ</button>
                    </div>
                    <div class="forum-section">
                        <div class="section-header">üíå –í—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è</div>
                        <div class="section-body" id="messages-list"></div>
                    </div>
                </div>

                <!-- Profile View -->
                <div id="profile" class="view" style="display:none;">
                    <div class="user-status" id="profile-status"></div>
                    <div class="forum-section">
                        <div class="section-header">üë§ –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</div>
                        <div class="section-body" id="profile-content" style="padding: 12px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Login/Register Modal -->
    <div id="login-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <span id="login-title">üîì –í—Ö–æ–¥ / –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</span>
                <div class="modal-close" onclick="closeModal('login-modal')">√ó</div>
            </div>
            <div class="modal-body">
                <div style="margin-bottom: 15px;">
                    <button class="button" style="margin-right: 10px;" onclick="switchLoginTab('login')">–í—Ö–æ–¥</button>
                    <button class="button" onclick="switchLoginTab('register')">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
                </div>

                <!-- Login Tab -->
                <div id="login-tab">
                    <div class="form-group">
                        <label>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
                        <input type="text" class="input-field" id="login-username" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è..." style="width: 100%;">
                    </div>
                    <div class="form-group">
                        <label>–ü–∞—Ä–æ–ª—å:</label>
                        <input type="password" class="input-field" id="login-password" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å..." style="width: 100%;">
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <button class="button primary" onclick="performLogin()">‚úì –í–æ–π—Ç–∏</button>
                        <button class="button" onclick="closeModal('login-modal')">‚úï –û—Ç–º–µ–Ω–∞</button>
                    </div>
                </div>

                <!-- Register Tab -->
                <div id="register-tab" style="display:none;">
                    <div class="form-group">
                        <label>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
                        <input type="text" class="input-field" id="register-username" placeholder="3-20 —Å–∏–º–≤–æ–ª–æ–≤..." style="width: 100%;">
                    </div>
                    <div class="form-group">
                        <label>Email:</label>
                        <input type="email" class="input-field" id="register-email" placeholder="your@email.com" style="width: 100%;">
                    </div>
                    <div class="form-group">
                        <label>–ü–∞—Ä–æ–ª—å:</label>
                        <input type="password" class="input-field" id="register-password" placeholder="–ú–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤..." style="width: 100%;">
                    </div>
                    <div class="form-group">
                        <label>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è:</label>
                        <input type="password" class="input-field" id="register-password2" placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å..." style="width: 100%;">
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <button class="button primary" onclick="performRegister()">‚úì –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                        <button class="button" onclick="closeModal('login-modal')">‚úï –û—Ç–º–µ–Ω–∞</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- New Thread Modal -->
    <div id="new-thread-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <span>üìù –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Ç–µ–º—É</span>
                <div class="modal-close" onclick="closeModal('new-thread-modal')">√ó</div>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>–§–æ—Ä—É–º:</label>
                    <select class="input-field" id="thread-forum" style="width: 100%;">
                        <option value="0">–û—Å–Ω–æ–≤–Ω–æ–µ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ</option>
                        <option value="1">–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</option>
                        <option value="2">–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>–ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–µ–º—ã:</label>
                    <input type="text" class="input-field" id="thread-title-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫..." style="width: 100%;">
                </div>
                <div class="form-group">
                    <label>–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:</label>
                    <textarea class="textarea" id="thread-text-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è..."></textarea>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="thread-private"> üîí –ü—Ä–∏–≤–∞—Ç–Ω–∞—è —Ç–µ–º–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
                    </label>
                </div>
                <div id="private-users-select" style="display:none; margin-bottom: 10px;">
                    <label>–î–∞—Ç—å –¥–æ—Å—Ç—É–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º:</label>
                    <div id="users-checkboxes" style="max-height: 150px; overflow-y: auto; border: 1px solid #ccc; padding: 5px;"></div>
                </div>
                <div style="display: flex; gap: 10px;">
                    <button class="button primary" onclick="createNewThread()">‚úì –°–æ–∑–¥–∞—Ç—å —Ç–µ–º—É</button>
                    <button class="button" onclick="closeModal('new-thread-modal')">‚úï –û—Ç–º–µ–Ω–∞</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Reply Modal -->
    <div id="reply-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <span>üí¨ –û—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ —Ç–µ–º—É</span>
                <div class="modal-close" onclick="closeModal('reply-modal')">√ó</div>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>–í–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:</label>
                    <textarea class="textarea" id="reply-text" placeholder="–í–≤–µ–¥–∏—Ç–µ –æ—Ç–≤–µ—Ç..."></textarea>
                </div>
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button class="button" onclick="closeModal('reply-modal')">‚úï –û—Ç–º–µ–Ω–∞</button>
                    <button class="button primary" onclick="addReply()">‚úì –û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Send Message Modal -->
    <div id="send-message-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <span>‚úâÔ∏è –ù–æ–≤–æ–µ –ø—Ä–∏–≤–∞—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ</span>
                <div class="modal-close" onclick="closeModal('send-message-modal')">√ó</div>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>–ö–æ–º—É:</label>
                    <select class="input-field" id="message-recipient" style="width: 100%;">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>–¢–µ–º–∞:</label>
                    <input type="text" class="input-field" id="message-subject" placeholder="–¢–µ–º–∞ —Å–æ–æ–±—â–µ–Ω–∏—è..." style="width: 100%;">
                </div>
                <div class="form-group">
                    <label>–°–æ–æ–±—â–µ–Ω–∏–µ:</label>
                    <textarea class="textarea" id="message-text" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç..."></textarea>
                </div>
                <div style="display: flex; gap: 10px;">
                    <button class="button primary" onclick="sendPrivateMessage()">‚úì –û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                    <button class="button" onclick="closeModal('send-message-modal')">‚úï –û—Ç–º–µ–Ω–∞</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============ DATA STRUCTURE ============
        const forumData = {
            users: [],
            forums: [
                { id: 0, name: '–û—Å–Ω–æ–≤–Ω–æ–µ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ', desc: '–¢–µ–º—ã –æ–±—â–µ–≥–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞ –∏ –Ω–æ–≤–æ—Å—Ç–∏', threads: [] },
                { id: 1, name: '–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏', desc: '–û–±—Å—É–∂–¥–µ–Ω–∏–µ –ü–ö –∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞', threads: [] },
                { id: 2, name: '–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è', desc: '–ò–≥—Ä—ã, –∫–∏–Ω–æ –∏ —Ö–æ–±–±–∏', threads: [] }
            ],
            messages: []
        };

        let currentUser = null;
        let currentForum = null;
        let currentThread = null;

        // ============ STORAGE MANAGEMENT ============
        function saveData() {
            localStorage.setItem('forumData', JSON.stringify(forumData));
        }

        function loadData() {
            const data = localStorage.getItem('forumData');
            if (data) {
                const loaded = JSON.parse(data);
                forumData.users = loaded.users || [];
                forumData.forums = loaded.forums || forumData.forums;
                forumData.messages = loaded.messages || [];
            }
        }

        function getCurrentUser() {
            const user = localStorage.getItem('currentUser');
            return user ? JSON.parse(user) : null;
        }

        function setCurrentUser(user) {
            currentUser = user;
            if (user) {
                localStorage.setItem('currentUser', JSON.stringify(user));
            } else {
                localStorage.removeItem('currentUser');
            }
            updateHeader();
        }

        // ============ AUTH FUNCTIONS ============
        function openLoginModal() {
            document.getElementById('login-modal').classList.add('active');
        }

        function closeLoginModal() {
            closeModal('login-modal');
        }

        function switchLoginTab(tab) {
            document.getElementById('login-tab').style.display = tab === 'login' ? 'block' : 'none';
            document.getElementById('register-tab').style.display = tab === 'register' ? 'block' : 'none';
        }

        function performLogin() {
            const username = document.getElementById('login-username').value.trim();
            const password = document.getElementById('login-password').value;

            if (!username || !password) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!');
                return;
            }

            const user = forumData.users.find(u => u.username === username && u.password === password);
            if (!user) {
                alert('–ù–µ–≤–µ—Ä–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –ø–∞—Ä–æ–ª—å!');
                return;
            }

            setCurrentUser(user);
            document.getElementById('login-username').value = '';
            document.getElementById('login-password').value = '';
            closeModal('login-modal');
            showView('forums');
            alert(`‚úì –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${username}!`);
        }

        function performRegister() {
            const username = document.getElementById('register-username').value.trim();
            const email = document.getElementById('register-email').value.trim();
            const password = document.getElementById('register-password').value;
            const password2 = document.getElementById('register-password2').value;

            if (!username || !email || !password || !password2) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!');
                return;
            }

            if (username.length < 3 || username.length > 20) {
                alert('–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Ç 3 –¥–æ 20 —Å–∏–º–≤–æ–ª–æ–≤!');
                return;
            }

            if (password.length < 6) {
                alert('–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤!');
                return;
            }

            if (password !== password2) {
                alert('–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç!');
                return;
            }

            if (forumData.users.find(u => u.username === username)) {
                alert('–≠—Ç–æ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —É–∂–µ –∑–∞–Ω—è—Ç–æ!');
                return;
            }

            const newUser = {
                id: Date.now(),
                username: username,
                email: email,
                password: password,
                avatar: username[0].toUpperCase(),
                joinDate: new Date().toLocaleDateString('ru-RU'),
                threads: [],
                posts: []
            };

            forumData.users.push(newUser);
            saveData();

            document.getElementById('register-username').value = '';
            document.getElementById('register-email').value = '';
            document.getElementById('register-password').value = '';
            document.getElementById('register-password2').value = '';

            switchLoginTab('login');
            alert(`‚úì –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞! –¢–µ–ø–µ—Ä—å –≤–æ–π–¥–∏—Ç–µ —Å –≤–∞—à–∏–º–∏ —É—á—ë—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.`);
        }

        function logout() {
            setCurrentUser(null);
            currentForum = null;
            currentThread = null;
            showView('forums');
            alert('–í—ã –≤—ã—à–ª–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã');
        }

        function openLoginModal() {
            document.getElementById('login-modal').classList.add('active');
            switchLoginTab('login');
        }

        // ============ FORUM FUNCTIONS ============
        function showView(view) {
            document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
            document.getElementById(view).classList.add('active');

            if (view === 'messages' && !currentUser) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç!');
                openLoginModal();
                showView('forums');
                return;
            }

            if (view === 'profile' && !currentUser) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç!');
                openLoginModal();
                showView('forums');
                return;
            }

            if (view === 'messages') {
                updateMessages();
            } else if (view === 'profile') {
                updateProfile();
            }
        }

        function showForum(forumId) {
            if (!currentUser) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ñ–æ—Ä—É–º–æ–≤!');
                openLoginModal();
                return;
            }

            currentForum = forumId;
            const forum = forumData.forums[forumId];
            document.getElementById('forum-title').textContent = 'üìÅ ' + forum.name;

            const threadsList = document.getElementById('threads-list');
            threadsList.innerHTML = '';

            const availableThreads = forum.threads.filter(thread => {
                if (thread.isPrivate) {
                    return thread.allowedUsers && thread.allowedUsers.includes(currentUser.id);
                }
                return true;
            });

            if (availableThreads.length === 0) {
                threadsList.innerHTML = '<div class="no-data">–í —ç—Ç–æ–º —Ñ–æ—Ä—É–º–µ –ø–æ–∫–∞ –Ω–µ—Ç —Ç–µ–º. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º–∏! üìù</div>';
            } else {
                availableThreads.forEach((thread, idx) => {
                    const originalIdx = forum.threads.indexOf(thread);
                    const postsCount = thread.posts.length;
                    const lockBadge = thread.isPrivate ? '<span class="lock-badge">üîí –ü–†–ò–í–ê–¢–ù–ê–Ø</span>' : '';
                    threadsList.innerHTML += `
                        <div class="thread-item">
                            <div class="thread-icon">${postsCount > 5 ? 'üî•' : 'üí¨'}</div>
                            <div class="thread-info">
                                <h4 onclick="showThread(${forumId}, ${originalIdx})">${thread.title}</h4>
                                <p>–ê–≤—Ç–æ—Ä: <strong>${thread.author}</strong> | ${thread.date} ${lockBadge}</p>
                            </div>
                            <div class="forum-stats">
                                <strong>${postsCount}</strong><br><small>–æ—Ç–≤–µ—Ç.</small>
                            </div>
                            <button class="button" onclick="showThread(${forumId}, ${originalIdx})">–û—Ç–∫—Ä—ã—Ç—å ‚Üí</button>
                        </div>
                    `;
                });
            }

            document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
            document.getElementById('forum-view').classList.add('active');
        }

        function backToForums() {
            showView('forums');
            currentForum = null;
        }

        function backToForum() {
            if (currentForum !== null) {
                showForum(currentForum);
            }
        }

        function showThread(forumId, threadId) {
            currentForum = forumId;
            currentThread = threadId;
            const thread = forumData.forums[forumId].threads[threadId];

            if (thread.isPrivate && (!thread.allowedUsers || !thread.allowedUsers.includes(currentUser.id))) {
                alert('–£ –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–π —Ç–µ–º–µ!');
                return;
            }

            document.getElementById('thread-title').textContent = 'üí¨ ' + thread.title;

            const postsList = document.getElementById('posts-list');
            postsList.innerHTML = '';

            thread.posts.forEach((post) => {
                const posterUser = forumData.users.find(u => u.id === post.userId);
                const posterName = posterUser ? posterUser.username : '–£–¥–∞–ª—ë–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
                const posterAvatar = posterUser ? posterUser.avatar : '?';

                postsList.innerHTML += `
                    <div class="post-item">
                        <div class="post-header">
                            üìå ${posterName}
                            <span>${post.date}</span>
                        </div>
                        <div class="post-body">
                            <div class="post-avatar">${posterAvatar}</div>
                            <div class="post-content">${post.text}</div>
                        </div>
                        <div class="post-footer">
                            ‚≠ê –ü—Ä–æ—Ñ–∏–ª—å | ‚úâÔ∏è –°–æ–æ–±—â–µ–Ω–∏–µ | üîó –¶–∏—Ç–∞—Ç–∞
                        </div>
                    </div>
                `;
            });

            document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
            document.getElementById('thread-view').classList.add('active');
        }

        function openNewThreadModal() {
            if (!currentUser) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç!');
                openLoginModal();
                return;
            }
            updateUsersCheckboxes();
            document.getElementById('new-thread-modal').classList.add('active');
        }

        function updateUsersCheckboxes() {
            const container = document.getElementById('users-checkboxes');
            container.innerHTML = '';
            forumData.users.forEach(user => {
                if (user.id !== currentUser.id) {
                    container.innerHTML += `
                        <label style="display: block; margin: 3px 0;">
                            <input type="checkbox" value="${user.id}" class="user-checkbox"> ${user.username}
                        </label>
                    `;
                }
            });
        }

        document.getElementById('thread-private')?.addEventListener('change', function() {
            document.getElementById('private-users-select').style.display = this.checked ? 'block' : 'none';
        });

        function createNewThread() {
            if (!currentUser) return;

            const title = document.getElementById('thread-title-input').value.trim();
            const text = document.getElementById('thread-text-input').value.trim();
            const forumId = parseInt(document.getElementById('thread-forum').value);
            const isPrivate = document.getElementById('thread-private').checked;

            if (!title || !text) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!');
                return;
            }

            let allowedUsers = [currentUser.id];
            if (isPrivate) {
                const checkboxes = document.querySelectorAll('.user-checkbox:checked');
                if (checkboxes.length === 0) {
                    alert('–í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –ø—Ä–∏–≤–∞—Ç–Ω–æ–π —Ç–µ–º—ã!');
                    return;
                }
                checkboxes.forEach(cb => {
                    allowedUsers.push(parseInt(cb.value));
                });
            }

            const newThread = {
                id: Date.now(),
                title: title,
                author: currentUser.username,
                authorId: currentUser.id,
                date: new Date().toLocaleDateString('ru-RU'),
                isPrivate: isPrivate,
                allowedUsers: isPrivate ? allowedUsers : null,
                posts: [{
                    id: Date.now(),
                    userId: currentUser.id,
                    text: text,
                    date: new Date().toLocaleString('ru-RU')
                }]
            };

            forumData.forums[forumId].threads.push(newThread);
            saveData();

            document.getElementById('thread-title-input').value = '';
            document.getElementById('thread-text-input').value = '';
            document.getElementById('thread-private').checked = false;

            closeModal('new-thread-modal');
            alert('‚úì –¢–µ–º–∞ —Å–æ–∑–¥–∞–Ω–∞ —É—Å–ø–µ—à–Ω–æ!');
            showForum(forumId);
        }

        function openReplyModal() {
            if (!currentUser) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç!');
                return;
            }
            document.getElementById('reply-modal').classList.add('active');
        }

        function addReply() {
            if (!currentUser || currentForum === null || currentThread === null) return;

            const text = document.getElementById('reply-text').value.trim();
            if (!text) {
                alert('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è!');
                return;
            }

            const thread = forumData.forums[currentForum].threads[currentThread];
            thread.posts.push({
                id: Date.now(),
                userId: currentUser.id,
                text: text,
                date: new Date().toLocaleString('ru-RU')
            });

            saveData();
            document.getElementById('reply-text').value = '';
            closeModal('reply-modal');
            showThread(currentForum, currentThread);
            alert('‚úì –û—Ç–≤–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω!');
        }

        // ============ MESSAGES FUNCTIONS ============
        function openSendMessageModal() {
            if (!currentUser) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç!');
                return;
            }

            const select = document.getElementById('message-recipient');
            select.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...</option>';
            forumData.users.forEach(user => {
                if (user.id !== currentUser.id) {
                    select.innerHTML += `<option value="${user.id}">${user.username}</option>`;
                }
            });

            document.getElementById('send-message-modal').classList.add('active');
        }

        function sendPrivateMessage() {
            if (!currentUser) return;

            const recipientId = parseInt(document.getElementById('message-recipient').value);
            const subject = document.getElementById('message-subject').value.trim();
            const text = document.getElementById('message-text').value.trim();

            if (!recipientId || !subject || !text) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!');
                return;
            }

            const recipient = forumData.users.find(u => u.id === recipientId);
            if (!recipient) {
                alert('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω!');
                return;
            }

            forumData.messages.push({
                id: Date.now(),
                from: currentUser.id,
                fromName: currentUser.username,
                to: recipientId,
                subject: subject,
                text: text,
                date: new Date().toLocaleString('ru-RU'),
                read: false
            });

            saveData();
            document.getElementById('message-subject').value = '';
            document.getElementById('message-text').value = '';
            closeModal('send-message-modal');
            alert('‚úì –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ!');
        }

        function updateMessages() {
            if (!currentUser) return;

            const messagesList = document.getElementById('messages-list');
            const messageStatus = document.getElementById('message-status');

            messageStatus.innerHTML = `<strong>–ü—Ä–∏–≤–µ—Ç, ${currentUser.username}!</strong> –ó–¥–µ—Å—å –ø–æ–∫–∞–∑–∞–Ω—ã –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –≤–∞–º.`;

            const myMessages = forumData.messages.filter(m => m.to === currentUser.id);

            if (myMessages.length === 0) {
                messagesList.innerHTML = '<div class="no-data">–£ –≤–∞—Å –Ω–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π</div>';
                return;
            }

            messagesList.innerHTML = '';
            myMessages.forEach(msg => {
                messagesList.innerHTML += `
                    <div class="message-item" onclick="alert('–û—Ç: ${msg.fromName}\\n–¢–µ–º–∞: ${msg.subject}\\n\\n${msg.text}')">
                        <div class="message-from">–û—Ç: ${msg.fromName}</div>
                        <div style="font-weight: bold; color: #333;">${msg.subject}</div>
                        <div class="message-text">${msg.text.substring(0, 100)}${msg.text.length > 100 ? '...' : ''}</div>
                        <div class="message-time">${msg.date}</div>
                    </div>
                `;
            });
        }

        // ============ PROFILE FUNCTIONS ============
        function updateProfile() {
            if (!currentUser) return;

            const profileStatus = document.getElementById('profile-status');
            const profileContent = document.getElementById('profile-content');

            profileStatus.innerHTML = `<strong>–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</strong> ${currentUser.username}`;

            const userThreads = forumData.forums.reduce((acc, forum) => {
                return acc + forum.threads.filter(t => t.authorId === currentUser.id).length;
            }, 0);

            const userPosts = forumData.forums.reduce((acc, forum) => {
                return acc + forum.threads.reduce((acc2, thread) => {
                    return acc2 + thread.posts.filter(p => p.userId === currentUser.id).length;
                }, 0);
            }, 0);

            profileContent.innerHTML = `
                <div style="margin-bottom: 15px;">
                    <div style="font-size: 18px; margin-bottom: 10px;">
                        <span style="font-size: 40px; font-weight: bold; color: #1f5b9c;">${currentUser.avatar}</span>
                    </div>
                    <p><strong>–ò–º—è:</strong> ${currentUser.username}</p>
                    <p><strong>Email:</strong> ${currentUser.email}</p>
                    <p><strong>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:</strong> ${currentUser.joinDate}</p>
                    <p><strong>–°–æ–∑–¥–∞–Ω–æ —Ç–µ–º:</strong> ${userThreads}</p>
                    <p><strong>–°–æ–∑–¥–∞–Ω–æ –ø–æ—Å—Ç–æ–≤:</strong> ${userPosts}</p>
                </div>
                <button class="button danger" onclick="logout()">üö™ –í—ã—Ö–æ–¥</button>
            `;
        }

        // ============ UI UPDATE FUNCTIONS ============
        function updateHeader() {
            const headerStatus = document.getElementById('header-status');
            const logoutBtn = document.getElementById('logout-btn');
            const createThreadBtn = document.getElementById('create-thread-btn');
            const replyBtn = document.getElementById('reply-btn');

            if (currentUser) {
                headerStatus.innerHTML = `<p>–í—ã –≤–æ—à–ª–∏ –∫–∞–∫:</p><p><strong>${currentUser.username}</strong></p>`;
                logoutBtn.style.display = 'inline-block';
                if (createThreadBtn) createThreadBtn.style.display = 'inline-block';
                if (replyBtn) replyBtn.style.display = 'inline-block';
            } else {
                headerStatus.innerHTML = '<p>–í—ã –Ω–µ –≤–æ—à–ª–∏</p>';
                logoutBtn.style.display = 'none';
                if (createThreadBtn) createThreadBtn.style.display = 'none';
                if (replyBtn) replyBtn.style.display = 'none';
            }

            updateStats();
            updateLatestUsers();
        }

        function updateStats() {
            document.getElementById('total-users').textContent = forumData.users.length;
            document.getElementById('online-users').textContent = currentUser ? 1 : 0;

            let totalThreads = 0;
            let totalPosts = 0;

            forumData.forums.forEach((forum, idx) => {
                const accessibleThreads = forum.threads.filter(t => {
                    if (t.isPrivate) {
                        return currentUser && t.allowedUsers && t.allowedUsers.includes(currentUser.id);
                    }
                    return true;
                });

                totalThreads += accessibleThreads.length;
                document.getElementById(`forum-${idx}-threads`).textContent = accessibleThreads.length;

                let forumPosts = 0;
                accessibleThreads.forEach(thread => {
                    forumPosts += thread.posts.length;
                });

                totalPosts += forumPosts;
                document.getElementById(`forum-${idx}-posts`).textContent = forumPosts;
            });

            document.getElementById('total-threads').textContent = totalThreads;
            document.getElementById('total-posts').textContent = totalPosts;
        }

        function updateLatestUsers() {
            const container = document.getElementById('latest-users');
            if (forumData.users.length === 0) {
                container.innerHTML = '<p style="color: #999;">–ù–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</p>';
                return;
            }

            const latestUsers = forumData.users.slice(-5).reverse();
            container.innerHTML = '';
            latestUsers.forEach(user => {
                container.innerHTML += `<a onclick="alert('${user.username}\\n–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞: ${user.email}\\n–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω: ${user.joinDate}')">${user.username}</a>`;
            });
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.classList.remove('active');
            }
        };

        // ============ INITIALIZATION ============
        function init() {
            loadData();
            currentUser = getCurrentUser();
            updateHeader();

            // –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–∏–º–µ—Ä–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
            if (forumData.users.length === 0) {
                forumData.users = [
                    { id: 1, username: 'Admin', email: 'admin@forum.com', password: 'admin', avatar: 'A', joinDate: '2024-01-01' },
                    { id: 2, username: 'User2007', email: 'user@forum.com', password: '123456', avatar: 'U', joinDate: '2024-01-15' },
                    { id: 3, username: 'TestUser', email: 'test@forum.com', password: 'test123', avatar: 'T', joinDate: '2024-01-18' }
                ];

                // –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–∏–º–µ—Ä–Ω—ã–µ —Ç–µ–º—ã
                forumData.forums[0].threads = [
                    {
                        id: 1,
                        title: '–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ —Ñ–æ—Ä—É–º!',
                        author: 'Admin',
                        authorId: 1,
                        date: '2024-01-20',
                        isPrivate: false,
                        posts: [
                            { id: 1, userId: 1, text: '–ü—Ä–∏–≤–µ—Ç –≤—Å–µ–º! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ –Ω–∞—à —Ä–µ—Ç—Ä–æ-—Ñ–æ—Ä—É–º 2007 –≥–æ–¥–∞!', date: '2024-01-20 10:00' }
                        ]
                    }
                ];

                saveData();
            }
        }

        init();
    </script>
</body>
</html>
